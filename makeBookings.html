<html>
<head>
    <!-- Latest compiled and minified CSS -->
    <link rel="stylesheet" href="css/bootstrap.css">

    <!-- jQuery library -->
    <script src="js/jquery-2.1.3.js"></script>

    <!-- Latest compiled JavaScript -->
    <script src="js/bootstrap.js"></script>
    <script src="js/bootstrap.min.js"></script>

    <script src="js/date.js"></script>
    <script>
        function fetchRecord(activity) {
            var prefix = activity.substr(0, 1).toUpperCase();
            return { "Shaw": randomSlots(prefix), "Kwong On": randomSlots(prefix), "Hall": randomSlots(prefix) };
        }

        function randomSlots(prefix) {
            var today = Date.today();
            var result = {};
            for (var i = 0; i < 7; i++) {
                var date = today.addDays(i);
                if (date.getDay() != 0 && today.getDay() != 6) {
                    var day = result[today.toString("yyyy-MM-dd")] = {};
                    date.set({ hour: 8, minute: 30 });
                    for (var h = 0; h < 11; h++) {
                        if (Math.random() > .7) continue;
                        var time = date.add({ hours: h });
                        var slots = day[time.toString("HH:mm")] = [];
                        for (var court = 1; court <= 10; court++) {
                            if (Math.random() > .4) continue;
                            slots.push(prefix + ("00" + court.toString()).slice(-2));
                        }
                    }
                }
            }
            return result;
        }
    </script>
    <script type="text/javascript">
        var date;
        var start = 22;
        var end = 9;

        $("document").ready(function () {
            changeTable("#table0");
        });
        function select() {
            $('#addMeeting').hide();
            $('#selectDateTime').show();
        }
        function goBack() {
            $('#addMeeting').show();
            $('#selectDateTime').hide();
            $('#dateTime').val(date + " " + start + ":00-" + end + ":00");

        }
        function checked(target) {
            if ($(target).html() == '<span class="glyphicon glyphicon-ok" aria-hidden="true"></span>') $(target).html('');
            else $(target).html('<span class="glyphicon glyphicon-ok" aria-hidden="true"></span>');
            date = $(target).attr('date');
            if ($(target).attr('startTime') < start) start = $(target).attr('startTime');
            if ($(target).attr('endTime') > end) end = $(target).attr('endTime');
            console.log($(target).attr('date'));
            console.log($(target).attr('startTime'));
            console.log($(target).attr('endTime'));
            console.log(start);
            console.log(end);
        }

        function changeTable(table) {
            var t = $(table);
            $('table').not(t).removeClass('active');
            t.addClass('active');
            var x = $("li[table=" + table + "]");
            x.parent().find("li").removeClass("active");
            x.addClass("active");
        }

        function expand() {
            alert("Right click");
        }

        function selectSlot(target) {
            target = $(target);
            target.toggleClass("checked");
        }

        function populateTimetable(table, dates, dateLabels, times, timeLabels,
                                   slotAvailableCallback,
                                   slotCheckedCallback) {
            var t = $(table);
            t.empty();

            var thead = $("<tr><th>Time\\Date</th></tr>");
            for (var i = 0; i < dates.length; i++)
                thead.append($("<th></th>").text(dateLabels[i]));
            t.append($("<thead></thead>").append(thead));

            var tbody = $("<tbody></tbody>");
            for (var i = 0; i < times.length; i++) {
                var tr = $("<tr></tr>");
                tr.append($("<th scope=\"row\"></th>").text(timeLabels[i]));
                for (var j = 0; j < dates.length; j++) {
                    var td = $("<td></td>").attr("date", dates[i]).attr("time", times[j]);
                    if (slotAvailableCallback(dates[i], times[j])) {
                        td.addClass("success");
                        td.attr("onclick", "selectSlot(this)");
                    }
                    if (slotCheckedCallback(dates[i], times[j])) {
                        td.addClass("checked");
                    }
                    tr.append(td);
                }
                tbody.append(tr);
            }
            t.append(tbody);
        }

        $(function () {
            populateTimetable("#bookingTable #table0",
                    [1, 2, 3],
                    ["1d", "2d", "3d"],
                    [0, 1, 2, 3, 4, 5],
                    [0, 1, 2, 3, 4, 5],
                    function () {
                        return Math.random() > .5;
                    }, function () {
                        return Math.random() > .5;
                    }
            );
        })

    </script>

    <style type="text/css">
        .form-horizontal .control-label {
            /* text-align:right; */
            text-align : left;
        }

        table {
            display : none;
        }

        table.active {
            display : table;
        }

        #bookingTable td {
            text-align : center;
        }

        #bookingTable td.success {
            cursor : pointer;
        }

        #bookingTable td.checked:after {
            position                : relative;
            top                     : 1px;
            display                 : inline-block;
            font-family             : 'Glyphicons Halflings';
            font-style              : normal;
            font-weight             : normal;
            line-height             : 1;
            -webkit-font-smoothing  : antialiased;
            -moz-osx-font-smoothing : grayscale;
            content                 : "\e013";
        }

    </style>
</head>
<body>
    <nav class="navbar navbar-default">
        <div class="container-fluid">
            <!-- Brand and toggle get grouped for better mobile display -->
            <div class="navbar-header">
                <button type="button" class="navbar-toggle collapsed" data-toggle="collapse"
                        data-target="#bs-example-navbar-collapse-1">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" href="#">PolyU System</a>
            </div>

            <!-- Collect the nav links, forms, and other content for toggling -->
            <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
                <ul class="nav navbar-nav">
                    <li><a href="#">Notice</a></li>
                    <li><a href="#" class="active">Check/Make Bookings</a></li>
                    <li><a href="#">My Bookings</a></li>
                </ul>

                <ul class="nav navbar-nav navbar-right">
                    <li><a href="#" class="text-right">Sign Out</a></li>
                </ul>
            </div>
            <!-- /.navbar-collapse -->
        </div>
        <!-- /.container-fluid -->
    </nav>
    <div class="container">
        <div class="row">
            <div id="inquiry" class="col-sm-12 col-xs-12">
                <div class="form-horizontal">
                    <div class="form-group">
                        <label for="type" class="col-xs-2 control-label text-left">Activity:</label>

                        <div class="col-xs-9">
                            <select class="form-control" id="type">
                                <option>Badminton</option>
                                <option>Fitness training</option>
                                <option>Activities Room</option>
                                <option>Indoor Basketball</option>
                            </select>
                        </div>
                    </div>
                </div>
            </div>
            <div id="bookingTable" class="col-sm-12 col-xs-12 table-responsive">
                <ul class="nav nav-tabs">
                    <li role="presentation" table="#table0">
                        <a href="#"
                           onclick="changeTable(this.parentNode.getAttribute('table'))">shaw</a>
                    </li>
                    <li role="presentation" table="#table1">
                        <a href="#"
                           onclick="changeTable(this.parentNode.getAttribute('table'))">Core
                            W</a></li>
                    <li role="presentation" table="#table2">
                        <a href="#"
                           onclick="changeTable(this.parentNode.getAttribute('table'))">Student
                            Hall</a></li>
                </ul>
                <table class="table table-condensed table-bordered" id="table0">
                    <thead>
                    <tr>
                        <th>Time</th>
                        <th>22</th>
                        <th>23</th>
                        <th>24</th>
                        <th>25</th>
                        <th>26</th>
                        <th>27</th>
                        <th>28</th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr>
                        <th scope="row">9</th>
                        <td class="success" date="22/3" startTime="9" endTime="10" onclick=checked(this)></td>
                        <td class="success" date="23/3" startTime="9" endTime="10" onclick=checked(this)></td>
                        <td date="24/3" startTime="9" endTime="10"></td>
                        <td date="25/3" startTime="9" endTime="10"></td>
                        <td date="26/3" startTime="9" endTime="10"></td>
                        <td date="27/3" startTime="9" endTime="10"></td>
                        <td date="28/3" startTime="9" endTime="10"></td>
                    </tr>
                    <tr>
                        <th scope="row">10</th>
                        <td date="22/3" startTime="10" endTime="11"></td>
                        <td date="23/3" startTime="10" endTime="11"></td>
                        <td date="24/3" startTime="10" endTime="11" class="success" onclick=checked(this)></td>
                        <td date="25/3" startTime="10" endTime="11" class="success" onclick=checked(this)></td>
                        <td date="26/3" startTime="10" endTime="11"></td>
                        <td date="27/3" startTime="10" endTime="11"></td>
                        <td date="28/3" startTime="10" endTime="11"></td>
                    </tr>
                    <tr>
                        <th scope="row">11</th>
                        <td date="22/3" startTime="11" endTime="12"></td>
                        <td date="23/3" startTime="11" endTime="12"></td>
                        <td class="success" onclick=checked(this) date="24/3" startTime="11" endTime="12"></td>
                        <td class="success" onclick=checked(this) date="25/3" startTime="11" endTime="12"></td>
                        <td date="26/3" startTime="11" endTime="12"></td>
                        <td date="27/3" startTime="11" endTime="12"></td>
                        <td date="28/3" startTime="11" endTime="12"></td>
                    </tr>
                    <tr>
                        <th scope="row">12</th>
                        <td date="22/3" startTime="12" endTime="13"></td>
                        <td date="23/3" startTime="12" endTime="13"></td>
                        <td date="24/3" startTime="12" endTime="13" class="success" onclick=checked(this)></td>
                        <td date="25/3" startTime="12" endTime="13" class="success" onclick=checked(this)></td>
                        <td date="26/3" startTime="12" endTime="13"></td>
                        <td date="27/3" startTime="12" endTime="13"></td>
                        <td date="28/3" startTime="12" endTime="13" class="success" onclick=checked(this)></td>
                    </tr>
                    <tr>
                        <th scope="row">13</th>
                        <td date="22/3" startTime="13" endTime="14"></td>
                        <td date="23/3" startTime="13" endTime="14"></td>
                        <td date="24/3" startTime="13" endTime="14" class="success" onclick=checked(this)></td>
                        <td date="25/3" startTime="13" endTime="14" class="success" onclick=checked(this)></td>
                        <td date="26/3" startTime="13" endTime="14"></td>
                        <td date="27/3" startTime="13" endTime="14"></td>
                        <td date="28/3" startTime="13" endTime="14" class="success" onclick=checked(this)></td>
                    </tr>

                    </tbody>
                </table>
                <table class="table table-condensed table-bordered" id="table1">
                    <thead>
                    <tr>
                        <th>Time</th>
                        <th>22</th>
                        <th>23</th>
                        <th>24</th>
                        <th>25</th>
                        <th>26</th>
                        <th>27</th>
                        <th>28</th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr>
                        <th scope="row">9</th>
                        <td class="success" date="22/3" startTime="9" endTime="10" onclick=checked(this)></td>
                        <td class="success" date="23/3" startTime="9" endTime="10" onclick=checked(this)></td>
                        <td date="24/3" startTime="9" endTime="10"></td>
                        <td date="25/3" startTime="9" endTime="10"></td>
                        <td date="26/3" startTime="9" endTime="10"></td>
                        <td date="27/3" startTime="9" endTime="10"></td>
                        <td date="28/3" startTime="9" endTime="10"></td>
                    </tr>
                    <tr>
                        <th scope="row">10</th>
                        <td date="22/3" startTime="10" endTime="11"></td>
                        <td date="23/3" startTime="10" endTime="11"></td>
                        <td date="24/3" startTime="10" endTime="11" class="success" onclick=checked(this)></td>
                        <td date="25/3" startTime="10" endTime="11" class="success" onclick=checked(this)></td>
                        <td date="26/3" startTime="10" endTime="11"></td>
                        <td date="27/3" startTime="10" endTime="11"></td>
                        <td date="28/3" startTime="10" endTime="11"></td>
                    </tr>
                    <tr>
                        <th scope="row">11</th>
                        <td date="22/3" startTime="11" endTime="12"></td>
                        <td date="23/3" startTime="11" endTime="12"></td>
                        <td class="success" onclick=checked(this) date="24/3" startTime="11" endTime="12"></td>
                        <td class="success" onclick=checked(this) date="25/3" startTime="11" endTime="12"></td>
                        <td date="26/3" startTime="11" endTime="12"></td>
                        <td date="27/3" startTime="11" endTime="12"></td>
                        <td date="28/3" startTime="11" endTime="12"></td>
                    </tr>
                    <tr>
                        <th scope="row">12</th>
                        <td date="22/3" startTime="12" endTime="13"></td>
                        <td date="23/3" startTime="12" endTime="13"></td>
                        <td date="24/3" startTime="12" endTime="13" class="success" onclick=checked(this)></td>
                        <td date="25/3" startTime="12" endTime="13" class="success" onclick=checked(this)></td>
                        <td date="26/3" startTime="12" endTime="13"></td>
                        <td date="27/3" startTime="12" endTime="13"></td>
                        <td date="28/3" startTime="12" endTime="13" class="success" onclick=checked(this)></td>
                    </tr>
                    <tr>
                        <th scope="row">13</th>
                        <td date="22/3" startTime="13" endTime="14"></td>
                        <td date="23/3" startTime="13" endTime="14"></td>
                        <td date="24/3" startTime="13" endTime="14"></td>
                        <td date="25/3" startTime="13" endTime="14"></td>
                        <td date="26/3" startTime="13" endTime="14"></td>
                        <td date="27/3" startTime="13" endTime="14"></td>
                        <td date="28/3" startTime="13" endTime="14" class="success" onclick=checked(this)></td>
                    </tr>

                    </tbody>
                </table>
                <table class="table table-condensed table-bordered" id="table2">
                    <thead>
                    <tr>
                        <th>Time</th>
                        <th>22</th>
                        <th>23</th>
                        <th>24</th>
                        <th>25</th>
                        <th>26</th>
                        <th>27</th>
                        <th>28</th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr>
                        <th scope="row">9</th>
                        <td class="success" date="22/3" startTime="9" endTime="10" onclick=checked(this)></td>
                        <td class="success" date="23/3" startTime="9" endTime="10" onclick=checked(this)></td>
                        <td date="24/3" startTime="9" endTime="10"></td>
                        <td date="25/3" startTime="9" endTime="10"></td>
                        <td date="26/3" startTime="9" endTime="10"></td>
                        <td date="27/3" startTime="9" endTime="10"></td>
                        <td date="28/3" startTime="9" endTime="10"></td>
                    </tr>
                    <tr>
                        <th scope="row">10</th>
                        <td date="22/3" startTime="10" endTime="11"></td>
                        <td date="23/3" startTime="10" endTime="11"></td>
                        <td date="24/3" startTime="10" endTime="11" class="success" onclick=checked(this)></td>
                        <td date="25/3" startTime="10" endTime="11" class="success" onclick=checked(this)></td>
                        <td date="26/3" startTime="10" endTime="11"></td>
                        <td date="27/3" startTime="10" endTime="11"></td>
                        <td date="28/3" startTime="10" endTime="11"></td>
                    </tr>
                    <tr>
                        <th scope="row">11</th>
                        <td date="22/3" startTime="11" endTime="12"></td>
                        <td date="23/3" startTime="11" endTime="12"></td>
                        <td date="24/3" startTime="11" endTime="12"></td>
                        <td date="25/3" startTime="11" endTime="12"></td>
                        <td date="26/3" startTime="11" endTime="12"></td>
                        <td date="27/3" startTime="11" endTime="12"></td>
                        <td date="28/3" startTime="11" endTime="12"></td>
                    </tr>
                    <tr>
                        <th scope="row">12</th>
                        <td date="22/3" startTime="12" endTime="13"></td>
                        <td date="23/3" startTime="12" endTime="13"></td>
                        <td date="24/3" startTime="12" endTime="13" class="success" onclick=checked(this)></td>
                        <td date="25/3" startTime="12" endTime="13" class="success" onclick=checked(this)></td>
                        <td date="26/3" startTime="12" endTime="13"></td>
                        <td date="27/3" startTime="12" endTime="13"></td>
                        <td date="28/3" startTime="12" endTime="13" class="success" onclick=checked(this)></td>
                    </tr>
                    <tr>
                        <th scope="row">13</th>
                        <td date="22/3" startTime="13" endTime="14"></td>
                        <td date="23/3" startTime="13" endTime="14"></td>
                        <td date="24/3" startTime="13" endTime="14" class="success" onclick=checked(this)></td>
                        <td date="25/3" startTime="13" endTime="14" class="success" onclick=checked(this)></td>
                        <td date="26/3" startTime="13" endTime="14"></td>
                        <td date="27/3" startTime="13" endTime="14"></td>
                        <td date="28/3" startTime="13" endTime="14" class="success" onclick=checked(this)></td>
                    </tr>

                    </tbody>
                </table>
                <div>&nbsp;</div>

                <button type="button" class="btn btn-primary btn-lg" onclick=goBack()>clear</button>
                <button type="button" class="btn btn-primary btn-lg" onclick=goBack() style="float:right;">Book</button>
            </div>
        </div>
    </div>
</body>
</html>
